\documentclass[acmsmall,nonacm]{acmart}

\usepackage{booktabs} % For formal tables
\usepackage{longtable}
\usepackage[utf8]{inputenc}
\usepackage{cleveref}

\usepackage[$natbiboptions$]{natbib}
\bibliographystyle{$if(biblio-style)$$biblio-style$$else$plainnat$endif$}

\usepackage[ruled]{algorithm2e} % For algorithms
\renewcommand{\algorithmcfname}{ALGORITHM}
\SetAlFnt{\small}
\SetAlCapFnt{\small}
\SetAlCapNameFnt{\small}
\SetAlCapHSkip{0pt}
\IncMargin{-\parindent}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

\usepackage[section]{placeins}

\let\Oldsection\section
\renewcommand{\section}{\FloatBarrier\Oldsection}

\let\Oldsubsection\subsection
\renewcommand{\subsection}{\FloatBarrier\Oldsubsection}

\let\Oldsubsubsection\subsubsection
\renewcommand{\subsubsection}{\FloatBarrier\Oldsubsubsection}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}



\begin{document}

$if(title)$
\title{$title$}
$else$
\title{Could not detect title}
$endif$
$if(subtitle)$
\subtitle{$subtitle$}
$endif$

$if(author)$
\author{$author.name$}
\affiliation{%
  \institution{$author.institute$}
  \country{$author.country$}
}
\email{$author.email$}
$endif$


$if(abstract)$
\begin{abstract}
$abstract$
\end{abstract}
$endif$

\maketitle

\renewcommand{\shortauthors}{$author.name$}

$if(toc)$
\setcounter{tocdepth}{$toc-depth$}
\tableofcontents
\pagebreak
$endif$


$body$


\bibliography{$for(bibliography)$$bibliography$$sep$,$endfor$}

\end{document}
